{"version":3,"sources":["../../src/pages/admin-supplier-detail/admin-supplier-detail.module.ts","../../src/pages/admin-supplier-detail/admin-supplier-detail.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AdminSupplierDetailPage } from './admin-supplier-detail';\n\n@NgModule({\n  declarations: [\n    AdminSupplierDetailPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AdminSupplierDetailPage),\n  ],\n})\nexport class AdminSupplierDetailPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/admin-supplier-detail/admin-supplier-detail.module.ts","import { Component, ElementRef, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, MenuController, AlertController } from 'ionic-angular';\nimport { GlobalheroProvider } from '../../providers/globalhero/globalhero';\nimport { FirebaseServicesProvider } from '../../providers/firebase-services/firebase-services';\nimport {DomSanitizer} from '@angular/platform-browser';\nimport { supplierFirebaseController } from '../../providers/firebase-services/supplierFirebaseController';\n/**\n * Generated class for the AdminAboutusPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage({\n  name: 'AdminSupplierDetailPage',\n  segment: 'admin/supplier/supplieredit',\n  defaultHistory: ['AdminPage']\n})\n@Component({\n  selector: 'page-admin-supplier-detail',\n  templateUrl: 'admin-supplier-detail.html',\n})\nexport class AdminSupplierDetailPage {\n  @ViewChild('itemContentInput') itemContentInput: ElementRef;\n\n  itemInput = {\n    shortDescription: '',\n    title: '',\n    detail: '',\n    mediaList: [],\n    status:true,\n    lastUpdated: null,\n    id:null\n  }\n  originalItemInput= null;\n  modificationMediaList = [];\n  currentChosenCatergory=null\n  /////////////////////////////////////////////////////////////////\n  mediaListToSend = []\n  editMedia = false\n  constructor(private supplierFirebaseController:supplierFirebaseController,\n    private sanitizer:DomSanitizer,private alertCtrl: AlertController, private fbservices: FirebaseServicesProvider, private global: GlobalheroProvider, private menuCrtl: MenuController, public navCtrl: NavController, public navParams: NavParams) {\n  }\n\n  goBack() {\n    this.navCtrl.pop()\n  }\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad AdminAboutusPage');\n  }\n  ionViewWillEnter() {\n    if(this.navParams.get('item')==null)\n    this.navCtrl.popToRoot();\n    else\n    {\n      this.originalItemInput=this.navParams.get('item');\n      this.itemInput=this.originalItemInput\n      this.currentChosenCatergory=this.navParams.get('currentChosenCatergory')\n    }\n  }\n  textAreaResize() {\n    var element = this.itemContentInput['_elementRef'].nativeElement.getElementsByClassName(\"text-input\")[0];\n    var scrollHeight = element.scrollHeight;\n    element.style.height = scrollHeight + 'px';\n    this.itemContentInput['_elementRef'].nativeElement.style.height = (scrollHeight + 16) + 'px';\n  }\n  fileChangeListener($event): void {\n    this.mediaListToSend = this.mediaListToSend.concat(this.fileListToArray($event.target.files));\n    let fileinput = document.getElementById(\"fileInputId\") as HTMLInputElement;\n    fileinput.value = null;\n    console.log(this.mediaListToSend)\n    if (this.mediaListToSend.length > 10) {\n      this.mediaListToSend.length = 10;\n      this.global.presentToast('Bạn chỉ được dùng tối đa 10 file media.')\n    }\n  }\n  fileListToArray(fileList) {\n    return Array.prototype.slice.call(fileList);\n  }\n  removeFileFromList(filename) {\n    for (let i = this.mediaListToSend.length - 1; i >= 0; i--) {\n      if (this.mediaListToSend[i].name === filename) {\n        this.mediaListToSend.splice(i, 1);\n      }\n    }\n  }\n  validateInput() {\n    if (this.itemInput.title == '' || this.itemInput.detail == '')\n      this.global.presentToast('Các trường bắt buộc không thể bỏ trống');\n    else\n      {\n        this.supplierFirebaseController.updateNews(this.currentChosenCatergory, this.itemInput.id, this.itemInput).then(() => {\n          this.global.dismissLoading()\n          //update media if any\n          if (this.mediaListToSend.length > 0)\n            this.mediaUpload()\n          else\n            this.navCtrl.pop()\n        }).catch(err => {\n          this.global.dismissLoading()\n        })\n      }\n  }\n\n  mediaUpload() {\n    this.global.presentLoading('Đang upload các file media')\n    let promiseList = []\n    for (let media of this.mediaListToSend) {\n      promiseList.push(\n        this.fbservices.fbUploadFiles(media, 'news').then(\n          res => {\n            //url return\n            console.log(res)\n            //saveurl to news\n            this.supplierFirebaseController.addNewsMediaFileURLToDocumentObject(res, this.currentChosenCatergory, this.itemInput.id)\n          }\n        ).catch(err => {\n          console.log(err)\n        })\n      )\n    }\n    let self = this;\n    Promise.all(promiseList).then(function (values) {\n      console.log('All upload completed')\n      setTimeout(() => {\n        self.global.dismissLoading()\n      }, 1000);\n      self.mediaListToSend = []\n    })\n      .catch(err => {\n        self.global.dismissLoading()\n      });\n  }\n\n  openListOfCurrentMedia() {\n    this.modificationMediaList = Array.from(this.originalItemInput.mediaList)\n    this.editMedia = true\n  }\n  closeListOfCurrentMedia() {\n    this.editMedia = false\n    this.modificationMediaList = []\n  }\n  refreshModification() {\n    this.modificationMediaList = Array.from(this.originalItemInput.mediaList)\n  }\n  deleteModification(item) {\n    if (item == null)\n      this.modificationMediaList = []\n    else\n      for (let i = this.modificationMediaList.length - 1; i >= 0; i--) {\n        if (this.modificationMediaList[i] === item) {\n          this.modificationMediaList.splice(i, 1);\n        }\n      }\n  }\n  reorderItems(indexes) {\n    let element = this.modificationMediaList[indexes.from];\n    this.modificationMediaList.splice(indexes.from, 1);\n    this.modificationMediaList.splice(indexes.to, 0, element);\n  }\n  confirmMediaModification() {\n    if (JSON.stringify(this.originalItemInput.mediaList) == JSON.stringify(this.modificationMediaList)) {\n      //There is no modification, just exit\n      this.closeListOfCurrentMedia()\n    }\n    else {\n      let alert = this.alertCtrl.create({\n        title: 'Lưu ý',\n        message: 'Bạn có chắc chắn muốn cập nhật thay đổi?',\n        buttons: [\n          {\n            text: 'Không',\n            role: 'cancel',\n            handler: () => {\n              alert.dismiss();\n            }\n          },\n          {\n            text: 'Có',\n            handler: () => {\n              this.global.presentLoading('Sao lưu thay đổi')\n              let filesToDelete = this.originalItemInput.mediaList.filter(x => this.modificationMediaList.indexOf(x) === -1);\n              console.log(filesToDelete)\n              let promiseList = []\n              for (let file of filesToDelete) {\n                //delete files after remove during modification\n                promiseList.push(this.fbservices.deleteFileFromfbStorage(file))\n              }\n              promiseList.push(this.supplierFirebaseController.setMediaArrayToDocument(this.modificationMediaList, this.currentChosenCatergory, this.itemInput.id));\n              let self = this;\n              Promise.all(promiseList).then(function (values) {\n                self.global.dismissLoading()\n                self.global.presentToast('Sao lưu thành công')\n                self.closeListOfCurrentMedia();\n                self.navCtrl.pop()\n              })\n                .catch(err => {\n                  self.global.dismissLoading()\n                  self.global.presentToast('Đã có lỗi khi kết nối với hệ thống. Vui lòng thử lại sau')\n                });\n            }\n          }\n        ]\n      });\n      alert.present();\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/admin-supplier-detail/admin-supplier-detail.ts"],"sourceRoot":""}